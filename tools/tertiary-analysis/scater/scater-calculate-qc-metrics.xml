<tool id="scater-calculate-qc-metrics" name="Scater calculate qc metrics" version="@TOOL_VERSION@+galaxy0">
    <description>The QC metrics are calculated from serialized scater R object</description>
    <macros>
        <import>scater_macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        ln -s '$R_scater_serialized' R_scater_serialized.rds;

        scater-calculate-qc-metrics.R -i '$R_scater_serialized'
        								#if $exprs_values:
        									-e '$exprs_values'
        								#end if 
        								#if $feature_controls:
        									-f '$feature_controls'
        								#end if
        								#if $cell_controls:
        									-c '$cell_controls' 
        								#end if
        								#if $nmads:
        									-n '$nmads' 
        								#end if
        								#if $pct_feature_controls_threshold:
        									-p 'pct_feature_controls_threshold'
        								#end if
        								-o '$R_scater_qc' 
    ]]></command>
    <inputs>
        <param type="data" name="R_scater_serialized" format="rdata" />
        <param type="text" argument="--exprs-values" name="exprs_values" optional="True" value='counts' label="expression counts values from RDS object" help="Default: counts" />
        <param type="text" argument="--feature-controls" name="feature_controls" optional="True"  label="feature controls" />
        <param type="text" argument="--cell-controls" name="cell_controls" optional="True" label="cell controls" />
        <param type="integer" argument="--nmads" name="nmads" optional="True" label="number of median absolute deviations" />
        <param type="integer" argument="--pct-feature-controls-threshold" name="pct_feature_controls_threshold"  optional="True"  label="threshold for percentage of expression values" />
    </inputs>
    <outputs>
        <data name="R_scater_qc" format="rdata" label=""/>
    </outputs>
    <tests>
        <test>
            <param name="R_scater_serialized" value="R_scater_serialized.rds"/>
            <output name="R_scater_qc"  file="R_scater_qc.rds" />
        </test>
    </tests>
    <help><![CDATA[
    ]]></help>
    <expand macro="citations" />
</tool>