<?xml version="1.0" encoding="utf-8"?>
<tool id="convert-ftype" name="RDS to AnnData converstion" version="v0.0.1+galaxy0">
  <requirements>
    <requirement type="package" version="2.3.1">r-seurat</requirement>
  </requirements>
  <description>using seurat</description>
  <command detect_errors="exit_code"><![CDATA[
ln -s '${input_rds}' input.rds &&
cp ${script_file} rds2anndata.R &&
Rscript rds2anndata.R
]]></command>

  <configfiles>
    <configfile name="script_file"><![CDATA[
suppressPackageStartupMessages(library(Seurat))
rds <- readRDS('input.rds')
Convert(from=rds, to='anndata', filename='output.h5')
]]></configfile>
  </configfiles>

  <inputs>
    <param name="input_rds" type="data" format="rdata" label="Seurat object in RDS format"/>
  </inputs>

  <outputs>
    <data name="output_h5" format="h5" from_work_dir="output.h5" label="${tool.name} on ${on_string} anndata.h5"/>
  </outputs>

  <tests>
    <test>
      <param name="input_rds" value="pbmc3k_final.rds"/>
      <output name="output_h5" file="pbmc3k_final.h5ad" ftype="h5" compare="sim_size"/>
    </test>
  </tests>

  <help><![CDATA[
]]></help>
</tool>
