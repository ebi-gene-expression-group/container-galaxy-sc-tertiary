<tool id="fastq_pair" name="Paired-end fastq pairer" profile="18.01" version="1.0+galaxy0">
    <description>Rewrite paired-end fastq files to make sure that all reads have a mate and to separate out singletons.</description>
    <requirements>
        <requirement type="package" version="1.0">fastq-pair</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[

    ## Run fastq_pair
    fastq_pair

    #if $table_size:
        -t '$table_size'
    #end if

    #if $print_elements:
        -p '$print_elements'
    #end if

    #if $verbose:
        '$verbose'
    #end if

    '$fastq1' '$fastq2'

    ]]></command>
    <inputs>
        <param name="verbose" label="Verbose" optional="true" value="false" argument="-v" type="boolean" truevalue="-v" falsevalue="" checked="true" help="Verbose output. This is mainly for debugging." />
        <param name="fastq1" label="FASTQ file 1" type="data" format="fastqsanger" optional="false" help="FASTQ file input, file 1 of pair" />
        <param name="fastq2" label="FASTQ file 2" type="data" format="fastqsanger" optional="false" help="FASTQ file input, file 2 of pair" />
        <param name="table_size" label="Table size" argument="-t" optional="true" value="100003" type="integer" help="Table size (default 100003)" />
        <param name="print_elements" label="Number elements to print" argument="-p" type="integer" optional="true" help="Print this number of elements in each bucket in the table." />
    </inputs>
    <outputs>
        <data name="fastq1_paired" type="data" format_source="fastq1" from_work_dir="*.paired.fq" />
        <data name="fastq2_paired" type="data" format_source="fastq2" from_work_dir="*.paired.fq" />
        <data name="fastq1_single" type="data" format_source="fastq1" from_work_dir="*.single.fq" />
        <data name="fastq2_single" type="data" format_source="fastq2" from_work_dir="*.single.fq" />
        <!--collection name="f" type="list" format_source="fastq1" label="${tool.name} on ${on_string}: Paired reads">
            <data name="paired" from_work_dir="*.paired.fq" />
            <data name="single" from_work_dir="*.single.fq" />
        </collection>
        <collection name="r" type="list" format_source="fastq2" label="${tool.name} on ${on_string}: Singletons">
            <data name="paired" from_work_dir="*.paired.fq" />
            <data name="single" from_work_dir="*.single.fq" />
        </collection-->
    </outputs>
    <tests>
        <test>
            <param name="table_size" value="1000"/>
            <param name="fastq1" value="left.fastq"/>
            <param name="fastq2" value="right.fastq"/>
            <output name="fastq1_paired">
                <assert_contents><has_line_matching expression="^@GFH7CG303GRT2I/1[ -~]+" /></assert_contents>
            </output>
            <output name="fastq2_paired">
                <assert_contents><has_line_matching expression="^@GFH7CG303GRT2I/2[ -~]+" /></assert_contents>
            </output>
            <output name="fastq1_single">
                <assert_contents><has_line_matching expression="^@GFH7CG303GGIBL/1[ -~]+" /></assert_contents>
            </output>
            <output name="fastq2_single">
                <assert_contents><has_line_matching expression="^@GFH7CG303GSASH/2[ -~]+" /></assert_contents>
            </output>
            <!--output_collection name="f" type="list" count="2">
                <element name="paired" ftype="fq">
                    <assert_contents><has_line_matching expression="^@GFH7CG303GRT2I/1[ -~]+" /></assert_contents>
                </element>
                <element name="single" ftype="fq">
                    <assert_contents><has_line_matching expression="^@GFH7CG303GGIBL/1[ -~]+" /></assert_contents>
                </element>
            </output_collection>
            <output_collection name="r" type="list" count="2">
                <element name="paired" ftype="fq">
                    <assert_contents><has_line_matching expression="^@GFH7CG303GRT2I/2[ -~]+" /></assert_contents>
                </element>
                <element name="single" ftype="fq">
                    <assert_contents><has_line_matching expression="^@GFH7CG303GSASH/2[ -~]+" /></assert_contents>
                </element>
            </output_collection-->
        </test>
    </tests>
    <help><![CDATA[
=======================================================
Paired-end fastq pairer (fastq_pair)
=======================================================

Match up paired end fastq files quickly and efficiently. 

fastq_pair [options] [fastq file 1] [fastq file 2]

OPTIONS
-t table size (default 100003)
-p print the number of elements in each bucket in the table
-v verbose output. This is mainly for debugging
]]></help>
    <citations>
        <citation type="doi">10.1101/552885</citation>
    </citations>
</tool>
